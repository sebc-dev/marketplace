---
phase: 12-pilot
plan: 02
type: execute
wave: 2
depends_on: ["12-01"]
files_modified:
  - .claude/skills/astro-cloudflare/references/cloudflare-platform.md
autonomous: true

must_haves:
  truths:
    - "Every functional section in cloudflare-platform.md is wrapped in a descriptive XML container"
    - "All 8 grep patterns from SKILL.md targeting cloudflare-platform.md return exactly 1 match"
    - "git diff shows only added XML tag lines -- zero content modifications"
    - "Token overhead is below 5%"
  artifacts:
    - path: ".claude/skills/astro-cloudflare/references/cloudflare-platform.md"
      provides: "Pilot reference file with XML semantic containers"
      contains: "<quick_reference>"
  key_links:
    - from: ".planning/XML-CONVENTIONS.md"
      to: ".claude/skills/astro-cloudflare/references/cloudflare-platform.md"
      via: "conventions applied mechanically"
      pattern: "snake_case"
---

<objective>
Apply XML semantic containers to cloudflare-platform.md following the conventions from XML-CONVENTIONS.md, then validate with 4 automated checks.

Purpose: Validate the XML container pattern on the pilot file, confirming zero breakage and acceptable overhead.
Output: Restructured `cloudflare-platform.md` with 8 XML container tags (16 lines added).
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/XML-CONVENTIONS.md
@.planning/phases/12-pilot/12-CONTEXT.md
@.planning/phases/12-pilot/12-RESEARCH.md
@.planning/phases/12-pilot/12-01-SUMMARY.md
@.claude/skills/astro-cloudflare/references/cloudflare-platform.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Record baseline metrics and apply XML tags</name>
  <files>.claude/skills/astro-cloudflare/references/cloudflare-platform.md</files>
  <action>
**Step 1: Record baseline**
Run `wc -c .claude/skills/astro-cloudflare/references/cloudflare-platform.md` and note the byte count (expected: ~9,002 bytes).

**Step 2: Apply XML tags mechanically**

Apply exactly these 8 XML container tags to cloudflare-platform.md. Use the compact format (no blank line between tag and content). The file title `# Cloudflare Platform` gets NO tag.

Tag mapping (from RESEARCH.md validated tag budget):

1. **Lines 3-13** (## Quick Reference): Wrap with `<quick_reference>` / `</quick_reference>`
   - Opening tag on its own line BEFORE `## Quick Reference`
   - Closing tag on its own line AFTER line 13 (last numbered rule, "9. Avoid expensive...")

2. **Lines 15-68** (## Bindings Access): Wrap with `<bindings_access>` / `</bindings_access>`
   - Includes all code blocks, AsyncLocalStorage pattern, and both MCP callout blockquotes
   - Opening tag before `## Bindings Access`, closing tag after the MCP callout ending with queries

3. **Lines 70-81** (## Workers Limits): Wrap with `<workers_limits>` / `</workers_limits>`
   - Includes the resource limits table AND the MCP callout
   - Closing tag after the MCP callout line

4. **Lines 83-112** (## Node.js Compatibility): Wrap with `<nodejs_compatibility>` / `</nodejs_compatibility>`
   - Includes both tables (module status + compat flags) AND the MCP callout
   - Closing tag after the MCP callout line

5. **Lines 114-137** (## Environment Variables): Wrap with `<environment_variables>` / `</environment_variables>`
   - Includes code blocks and key rules list
   - Closing tag after "Use `keep_vars = true`..." line

6. **Lines 138-216** (## Config Templates): Wrap with `<config_templates>` / `</config_templates>`
   - This is the parent section containing ### wrangler.jsonc and ### .dev.vars
   - Includes both subsections and the MCP callout at the end
   - Do NOT add nested tags for the subsections in this pilot (start flat per RESEARCH.md recommendation)
   - Closing tag after the MCP callout line

7. **Lines 218-229** (## Anti-patterns): Wrap with `<anti_patterns>` / `</anti_patterns>`
   - Note: header says "Anti-patterns" (hyphenated), tag is `anti_patterns` (underscore) -- this is correct per conventions
   - Includes the Don't/Do/Impact table

8. **Lines 231-242** (## Troubleshooting): Wrap with `<troubleshooting>` / `</troubleshooting>`
   - Includes the Symptom/Cause/Fix table
   - Closing tag after the last table row

**CRITICAL RULES:**
- Do NOT modify ANY existing content (text, code, tables, blockquotes)
- Do NOT add blank lines between tags and content
- Do NOT change the order of sections
- Do NOT add a tag around `# Cloudflare Platform`
- Preserve all existing blank lines between sections
- Each XML tag line is its own line (not inline with content)

**Expected result:** 16 new lines added (8 opening + 8 closing tags), zero content modifications.
  </action>
  <verify>
Run all 4 validation checks:

1. **Grep patterns (8/8 must pass):**
```bash
cd .claude/skills/astro-cloudflare
grep -n "## Bindings Access" references/cloudflare-platform.md
grep -n "## Workers Limits" references/cloudflare-platform.md
grep -n "## Node.js Compatibility" references/cloudflare-platform.md
grep -n "## Environment Variables" references/cloudflare-platform.md
grep -n "### wrangler.jsonc" references/cloudflare-platform.md
grep -n "### .dev.vars" references/cloudflare-platform.md
grep -n "## Anti-patterns" references/cloudflare-platform.md
grep -n "## Troubleshooting" references/cloudflare-platform.md
```
Each must return exactly 1 result.

2. **Diff integrity:**
```bash
git diff .claude/skills/astro-cloudflare/references/cloudflare-platform.md | grep '^+' | grep -v '^+++' | grep -v '^+<' | grep -v '^+</'
```
Must return empty (all added lines are XML tags only).

3. **Token overhead:**
```bash
wc -c .claude/skills/astro-cloudflare/references/cloudflare-platform.md
```
Calculate: (new_size - 9002) / 9002 * 100. Must be < 5%.

4. **Tag well-formedness:**
```bash
grep -c '^<[a-z_]*>$' .claude/skills/astro-cloudflare/references/cloudflare-platform.md
grep -c '^</[a-z_]*>$' .claude/skills/astro-cloudflare/references/cloudflare-platform.md
```
Both counts must be equal (8 each).
  </verify>
  <done>
cloudflare-platform.md has 8 XML container tags wrapping every functional section. All 8 grep patterns return exactly 1 match. git diff shows only XML tag additions. Token overhead is below 5%. Opening and closing tag counts match (8 each).
  </done>
</task>

</tasks>

<verification>
1. All 8 SKILL.md grep patterns for cloudflare-platform.md pass (1 match each)
2. git diff shows ONLY added XML tag lines (zero content changes)
3. Token overhead < 5% (expected ~3.9%)
4. 8 opening tags = 8 closing tags
5. File is readable and well-structured
</verification>

<success_criteria>
cloudflare-platform.md is the validated pilot: every section has an XML container, zero breakage, under 5% overhead, and serves as the concrete template for phases 13-14.
</success_criteria>

<output>
After completion, create `.planning/phases/12-pilot/12-02-SUMMARY.md`
</output>
