---
phase: 08-mcp-tool-verification
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .planning/phases/08-mcp-tool-verification/08-VERIFICATION.md
autonomous: true

must_haves:
  truths:
    - "Exact MCP tool name is empirically confirmed by a successful tool call"
    - "Each of the 4 in-scope products (Workers, KV, D1, R2) has at least 1 test query with classified results"
    - "Query templates are ready to copy into SKILL.md for Phase 9"
    - "All tools on the Cloudflare MCP server are cataloged with skill-relevance classification"
    - "Return format is characterized with a real example (not reconstructed from source code)"
  artifacts:
    - path: ".planning/phases/08-mcp-tool-verification/08-VERIFICATION.md"
      provides: "Empirical verification report consumed by Phase 9"
      contains: "mcp__cloudflare__search_cloudflare_documentation"
      min_lines: 80
  key_links:
    - from: ".planning/phases/08-mcp-tool-verification/08-VERIFICATION.md"
      to: "Phase 9 SKILL.md content"
      via: "Query templates and tool specification sections"
      pattern: "Query Template"
---

<objective>
Empirically verify the Cloudflare Documentation MCP tool by executing 5-6 test queries, classifying result quality, and producing a structured verification document that Phase 9 can consume directly.

Purpose: Phase 8 is the hard blocker for all v0.2 content. Research confirmed tool specs from source code (HIGH confidence), but no empirical testing has been done. This plan runs real queries against the live MCP server to confirm the tool works as expected and to characterize its precision profile for the 4 in-scope Cloudflare products (Workers, KV, D1, R2).

Output: `.planning/phases/08-mcp-tool-verification/08-VERIFICATION.md` -- a structured report containing confirmed tool specification, precision profile, query templates for Phase 9, and formulation recommendations.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-mcp-tool-verification/08-CONTEXT.md
@.planning/phases/08-mcp-tool-verification/08-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Execute MCP test queries and classify results</name>
  <files>.planning/phases/08-mcp-tool-verification/08-VERIFICATION.md</files>
  <action>
Execute 6 test queries against the live Cloudflare MCP server using `mcp__cloudflare__search_cloudflare_documentation`. For each query, capture the raw XML results and classify each result as exact / partiel / hors sujet.

**Test queries to execute (6 queries, 1 per product + 2 Workers):**

1. **Workers runtime API:** `"Cloudflare Workers runtime API fetch handler and event lifecycle"` -- tests broad Workers coverage
2. **Workers compatibility flags:** `"Workers compatibility flags nodejs_compat compatibility date"` -- tests specific Workers config topic (also covers nodejs_compat per CONTEXT.md decision)
3. **KV binding:** `"Workers KV namespace put get delete API method parameters"` -- tests KV API reference
4. **D1 binding:** `"Cloudflare D1 database prepare bind query batch SQL API"` -- tests D1 API reference
5. **R2 binding:** `"Cloudflare R2 object storage put get list API parameters"` -- tests R2 API reference
6. **Ambiguous/generic:** `"how to configure bindings in wrangler.toml for Workers"` -- tests precision when query could match many products

**For each query, record:**
- The exact query string used
- Number of results returned (out of max 10)
- For each result: URL, title, classification (exact / partiel / hors sujet)
- Overall query rating: how many results were relevant to the intended product
- Notes on any surprises (wrong product results, particularly good/bad matches)

**Also verify:**
- Tool name `mcp__cloudflare__search_cloudflare_documentation` works (no "tool not found" error)
- Confirm the second tool `mcp__cloudflare__migrate_pages_to_workers_guide` exists by listing available tools (do NOT call it unless relevant)
- Parameter is just `{ query: string }` -- no other parameters accepted
- Return format matches expected XML structure (url, title, text fields)

**If MCP tool is unavailable (auth error, timeout, not found):**
- Document the exact error
- Record what was tried
- Note that Phase 9 should proceed with assumed tool names from research (HIGH confidence)
- Skip result classification -- the verification doc becomes a "fallback specification" document

**Write the full verification document directly.** Do not create a draft -- write the final 08-VERIFICATION.md in one pass, structuring it as described below.
  </action>
  <verify>
Verify the file exists and contains:
1. At least 6 query results sections with classification ratings
2. A confirmed tool specification section
3. At least 1 raw XML example in appendix
Run: `grep -c "exact\|partiel\|hors sujet" .planning/phases/08-mcp-tool-verification/08-VERIFICATION.md` should return 10+ matches (classifications across 6 queries)
  </verify>
  <done>
All 6 test queries executed and classified. Tool name empirically confirmed. Return format characterized with real data. Precision profile established for Workers, KV, D1, R2.
  </done>
</task>

<task type="auto">
  <name>Task 2: Finalize query templates and formulation recommendations for Phase 9</name>
  <files>.planning/phases/08-mcp-tool-verification/08-VERIFICATION.md</files>
  <action>
Review the classification results from Task 1 and ensure the verification document contains these Phase-9-ready sections:

**1. Confirmed Tool Specification (top of doc):**
- Fully qualified tool name (empirically confirmed)
- Parameter schema (confirmed)
- Return format (confirmed with real example)
- All tools on the CF MCP server with skill-relevance classification (search_cloudflare_documentation = YES, migrate_pages_to_workers_guide = out of scope for core skill but worth mentioning)

**2. Precision Profile:**
- Summary table: each product (Workers, KV, D1, R2) with precision rating (high/medium/low) based on test results
- Identify which products get the best results and which need more careful query formulation

**3. Query Templates for Phase 9 (ready to copy into SKILL.md):**
- Refine the research-phase query templates based on actual empirical results
- If a research-recommended template performed poorly, adjust it
- If a query pattern worked unexpectedly well, capture it
- Format: table with Product | Query Template | Purpose columns
- These must be directly copy-pasteable into SKILL.md

**4. Formulation Recommendations:**
- Concrete "prefer X over Y" recommendations based on the precision profile
- Specific anti-patterns observed in testing (e.g., "queries without product name returned N% irrelevant results")
- Note whether natural language or keyword-heavy queries performed better

**5. Appendix: 1 Raw Example:**
- Pick the most representative query result (good mix of exact/partiel results)
- Include the full raw XML response
- Annotate which results are exact vs partiel vs hors sujet

**Document structure must be directly consumable by Phase 9** -- the executor reading this doc should be able to write SKILL.md MCP integration content without re-running any queries or doing additional research.
  </action>
  <verify>
Verify completeness:
1. `grep -c "Query Template" .planning/phases/08-mcp-tool-verification/08-VERIFICATION.md` returns at least 1 (templates table exists)
2. `grep "Precision Profile\|precision" .planning/phases/08-mcp-tool-verification/08-VERIFICATION.md` confirms profile section exists
3. `grep "Appendix\|Raw Example" .planning/phases/08-mcp-tool-verification/08-VERIFICATION.md` confirms appendix exists
4. `grep "Formulation\|prefer\|Avoid" .planning/phases/08-mcp-tool-verification/08-VERIFICATION.md` confirms recommendations exist
5. Document is at least 80 lines
  </verify>
  <done>
08-VERIFICATION.md is a complete, Phase-9-ready verification report containing: confirmed tool spec, precision profile for all 4 products, refined query templates, concrete formulation recommendations, and 1 annotated raw example. Phase 9 executor can write SKILL.md content directly from this document.
  </done>
</task>

</tasks>

<verification>
Phase 8 success criteria from ROADMAP.md:
1. Exact fully qualified MCP tool name is documented -- check 08-VERIFICATION.md contains `mcp__cloudflare__search_cloudflare_documentation` as empirically confirmed
2. Parameter schema is confirmed -- check doc contains `query: string` confirmed by successful calls
3. Return format is characterized -- check doc contains real XML example (not reconstructed)
4. At least 3 test queries return relevant Cloudflare Workers/KV/D1 documentation -- check classification results show 3+ queries with majority "exact" or "partiel" results

Requirement VAL-01 (verification empirique du nom exact de l'outil MCP et de ses parametres) is satisfied when all 4 criteria above pass.
</verification>

<success_criteria>
- 08-VERIFICATION.md exists with 80+ lines
- Tool name empirically confirmed (not just from source code research)
- 6 test queries executed and classified
- Each in-scope product (Workers, KV, D1, R2) has at least 1 query with results
- Query templates refined from empirical data, ready for Phase 9
- Formulation recommendations are concrete ("prefer X over Y" format)
- 1 raw XML response included as appendix
- Document is directly consumable by Phase 9 executor without additional research
</success_criteria>

<output>
After completion, create `.planning/phases/08-mcp-tool-verification/08-01-SUMMARY.md`
</output>
